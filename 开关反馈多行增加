Sub 开关阀位反馈加行()

Dim hang, senu, hangs, ii, sh, e, f As Integer

'
' 宏1 宏
'
Dim sjy, a, b, c, d As String

i = 2

hang = Selection.Row


senu = Selection.Rows.Count


hangs = hang + senu - 1



For e = hang To hangs


 Sheets(1).Cells(e, 1).Interior.Color = 6

Next e


ii = ActiveSheet.UsedRange.Rows.Count




For sh = ii To 2 Step -1

sjy = Sheets(1).Cells(sh, 1)

If InStr(sjy, "V-") > 0 And Sheets(1).Cells(sh, 1).Interior.Color = 6 Then
                            a = Split(sjy, "V-")
                            b = Join(a, "ZVSO-")
                            c = Join(a, "ZVSC-")

    
Rows(sh + 1).Select
     For f = 1 To i

    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    Next f
                      
       Sheets(1).Cells(sh + 1, 1) = b
        Sheets(1).Cells(sh + 2, 1) = c
                 End If
                      
                      
                      Next sh
                      
                      ii = ActiveSheet.UsedRange.Rows.Count
                      Sheets(1).Range(Cells(2, 1), Cells(ii, 1)).Select
                              With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
Sheets(1).Rows(ii).Select
End Sub
