
Sub 表格汇总()



      Dim NewName6 As String
      NewName6 = InputBox("请输入新工作表的名称：")
      On Error GoTo endd
      Sheets(1).Activate
      Sheets.add.Name = NewName6



Dim j9, yl, i, a2, ll, kk, fl, kh, kh2, fl2, dh, lh, a3, lh2 As Integer
Dim arr() As Variant

yl = 1
fl = 0
j9 = 2
i = 1
ll = 0
a2 = 2

kk = 0

nei2:
Sheets(2).Activate



nei:

Do
kk = kk + 1

If ActiveSheet.Cells(1, kk).Text = "位号" And fl = 1 Then


yl = kk

ElseIf ActiveSheet.Cells(1, kk).Text = "数量" And fl = 2 Then

yl = kk

ElseIf ActiveSheet.Cells(1, kk).Text = "用途" And fl = 3 Then

yl = kk

ElseIf ActiveSheet.Cells(1, kk).Text = "温度" And fl = 4 Then

yl = kk

ElseIf ActiveSheet.Cells(1, kk).Text = "压力" And fl = 5 Then

yl = kk




End If



Loop Until ActiveSheet.Cells(1, kk).Text = ""
kk = 0

If fl = 0 Then
GoTo nx
End If


Do



    
Sheets(NewName6).Cells(a2, fl).Value = ActiveSheet.Cells(j9, yl).Text
    
j9 = j9 + 1
a2 = a2 + 1
   
    
Loop Until ActiveSheet.Cells(j9, 1).Text = "总数量"



 

j9 = 2

     If ActiveSheet.Index <> Worksheets.Count Then
         ActiveSheet.Next.Activate
         
         GoTo nei
    End If
    
a3 = a2
nx:
a2 = 2
fl = fl + 1

j9 = 2



If fl < 6 Then
GoTo nei2
End If

Sheets(1).Activate

 arr = Array("位号", "数量", "用途", "温度", "压力")
  Range(Cells(1, 1), Cells(1, 5)) = arr

                Sheets(NewName6).Cells(a3, 1).Value = "总数量"
        
        Sheets(NewName6).Cells(a3, 2).Value = Application.WorksheetFunction.Sum(Range(Cells(2, 2), Cells(a3, 2)))
        
         Range(Cells(1, 1), Cells(a3 - 1, 5)).Select
     Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    
        
       ' 行高 宏
'

'
    Selection.RowHeight = 22
    
    '字体设置
     With Selection.Font
        .Name = "宋体"
        .Size = 9
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
 ' 居中
'

'
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
 '自动列宽
       Range(Cells(1, 1), Cells(a3, 5)).Select
        Selection.Columns.AutoFit
        
        

        
        ' 加粗冻结 宏
        
 Range(Cells(1, 1), Cells(1, 5)).Select

'
    Selection.Font.Bold = True
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
    With ActiveWindow
        .SplitColumn = 0
        .SplitRow = 1
    End With
    ActiveWindow.FreezePanes = True

endd:
End Sub
