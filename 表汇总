
Sub a123333()



      Dim NewName6 As String
      NewName6 = InputBox("请输入新工作表的名称：")
      On Error GoTo endd
      Sheets(1).Activate
      Sheets.add.Name = NewName6



Dim j9, yl, i, a2, ll, kk, fl, kh, kh2, fl2, dh, lh, lh2 As Integer


yl = 1
fl = 0
j9 = 2
i = 1
ll = 0
a2 = 2

kk = 0

nei2:
Sheets(2).Activate



nei:

Do
kk = kk + 1

If ActiveSheet.Cells(1, kk).Text = "数量" And fl = 1 Then


yl = kk

ElseIf ActiveSheet.Cells(1, kk).Text = "温度" And fl = 2 Then

yl = kk

ElseIf ActiveSheet.Cells(1, kk).Text = "位号" And fl = 3 Then

yl = kk
End If



Loop Until ActiveSheet.Cells(1, kk).Text = ""
kk = 0

If fl = 0 Then
GoTo nx
End If


Do



    
Sheets(NewName6).Cells(a2, fl).Value = ActiveSheet.Cells(j9, yl).Text
    
j9 = j9 + 1
a2 = a2 + 1
   
    
Loop Until ActiveSheet.Cells(j9, 1).Text = ""



 

j9 = 2

     If ActiveSheet.Index <> Worksheets.Count Then
         ActiveSheet.Next.Activate
         
         GoTo nei
    End If
nx:
a2 = 2
fl = fl + 1

j9 = 2



If fl < 4 Then
GoTo nei2
End If
endd:
End Sub
